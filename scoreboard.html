@@ -371,50 +371,57 @@
      min-width: 40px;
      text-align: center;
      text-shadow: 0 0 10px rgba(243, 156, 18, 0.4);
    }

    .quarter-badges {
      display: flex;
      gap: 5px;
    }

    .quarter-dot {
      width: 12px;
      height: 12px;
      border-radius: 2px;
      background: #222;
      border: 1px solid #444;
      transform: skew(-15deg);
    }

    .quarter-dot.active {
      background: var(--gold);
      box-shadow: 0 0 8px var(--gold);
      border-color: #fff;
    }

    .quarter-dot.completed {
      background: #555;
      border-color: #666;
      box-shadow: none;
      opacity: 0.8;
    }

    .status-badge {
      background: linear-gradient(180deg, #f00 0%, #a00 100%);
      color: white;
      padding: 6px 20px;
      border-radius: 2px;
      font-weight: 900;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      transform: skew(-15deg);
      box-shadow: 0 0 25px rgba(255, 0, 0, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.4);
      animation: flashLive 2s infinite alternate;
    }

    @keyframes flashLive {
      from {
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        opacity: 0.8;
      }

      to {
        box-shadow: 0 0 35px rgba(255, 0, 0, 1);
        opacity: 1;
      }
@@ -533,51 +540,51 @@
      text-shadow: 0 2px 4px black;
    }

    /* Result Bars */
    .poll-results {
      display: none;
      /* Shown after voting */
      flex-direction: column;
      gap: 20px;
    }

    .poll-bar-container {
      position: relative;
      height: 45px;
      background: #000;
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid #333;
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.8);
    }

    .poll-bar {
      height: 100%;
      width: 50%;
      /* Default */
      transition: width 1s cubic-bezier(0.1, 0.7, 1.0, 0.1);
      transition: width 0.8s ease;
      position: relative;
    }

    .poll-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.1) 0%, transparent 100%);
    }

    .poll-bar.home {
      background: linear-gradient(90deg, #2980b9, #3498db);
      box-shadow: 0 0 20px rgba(52, 152, 219, 0.4);
    }

    .poll-bar.away {
      background: linear-gradient(90deg, #c0392b, #e74c3c);
      box-shadow: 0 0 20px rgba(231, 76, 60, 0.4);
    }

    .bar-label {
      position: absolute;
@@ -605,52 +612,53 @@
      letter-spacing: 1px;
      display: none;
    }

    @media (max-width: 768px) {
      .vote-options {
        gap: 20px;
      }

      .vote-btn .team-logo {
        width: 80px;
        height: 80px;
      }

      .poll-bar-container {
        height: 35px;
      }
    }

    /* WATERMARK */
    .watermark {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      opacity: 0.3;
      filter: grayscale(100%);
      pointer-events: none;
      opacity: 0.18;
      filter: drop-shadow(0 0 6px rgba(0, 0, 0, .7));
      z-index: 99;
    }

    /* RESPONSIVE - MOBILE OPTIMIZATION */
    @media (max-width: 768px) {
      body {
        padding: 10px 5px;
      }

      .wrap {
        padding: 0 5px;
      }

      .scoreboard-inner {
        grid-template-columns: 1fr;
        gap: 0;
      }

      .center-block {
        display: none;
      }

      .team-panel {
        height: 110px;
        padding: 0 20px;
@@ -1008,135 +1016,140 @@
    }

    function renderTimeline(data) {
      const list = document.getElementById("timelineList");
      list.innerHTML = "";
      const tl = data.timeline || [];
      if (!tl.length) {
        list.innerHTML = `<li class="muted">Sin jugadas registradas todavía.</li>`;
        return;
      }
      // Show in reverse order (newest first)
      [...tl].reverse().forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        list.appendChild(li);
      });
    }

    // ===== QB Stats =====
    function calcCmpPct(cmp, att) {
      if (!att) return "0%";
      return ((cmp / att) * 100).toFixed(1) + "%";
    }

    function renderQB(qb) {
      const container = document.getElementById("stats_container");
      container.style.display = "block";

      const title = document.getElementById("qbTitle");
      const nameLine = document.getElementById("qbNameLine");
      const cmpLine = document.getElementById("qbCmpLine");
      const nameLine = document.getElementById("qbName");
      const cmpLine = document.getElementById("qbPct");

      if (!qb) {
        title.textContent = "Estadísticas del QB";
        nameLine.textContent = "Nombre: —";
        cmpLine.textContent = "CMP/ATT: 0/0 (0%)";
        document.getElementById("qbPassYds").textContent = "Yds pase: 0";
        document.getElementById("qbPassTd").textContent = "TD pase: 0";
        document.getElementById("qbInts").textContent = "Intercepciones: 0";
        document.getElementById("qbRushYds").textContent = "Yds tierra: 0";
        document.getElementById("qbRushTd").textContent = "TD tierra: 0";
        document.getElementById("qbPassYds").textContent = "0";
        document.getElementById("qbPassTd").textContent = "0";
        document.getElementById("qbInts").textContent = "0";
        document.getElementById("qbRushYds").textContent = "0";
        document.getElementById("qbRushTd").textContent = "0";
        return;
      }

      const team = qb.team || "—";
      const name = qb.name || "—";
      const st = qb.stats || {};

      const cmp = st.pass_cmp || 0;
      const att = st.pass_att || 0;
      const pct = calcCmpPct(cmp, att);

      title.textContent = `Estadísticas del QB de ${team}`;
      nameLine.textContent = `Nombre: ${name}`;
      cmpLine.textContent = `CMP/ATT: ${cmp}/${att} (${pct})`;

      document.getElementById("qbPassYds").textContent = `Yds pase: ${st.pass_yds || 0}`;
      document.getElementById("qbPassTd").textContent = `TD pase: ${st.pass_td || 0}`;
      document.getElementById("qbInts").textContent = `Intercepciones: ${st.ints || 0}`;
      document.getElementById("qbRushYds").textContent = `Yds tierra: ${st.rush_yds || 0}`;
      document.getElementById("qbRushTd").textContent = `TD tierra: ${st.rush_td || 0}`;
      document.getElementById("qbPassYds").textContent = (st.pass_yds || 0);
      document.getElementById("qbPassTd").textContent = (st.pass_td || 0);
      document.getElementById("qbInts").textContent = (st.ints || 0);
      document.getElementById("qbRushYds").textContent = (st.rush_yds || 0);
      document.getElementById("qbRushTd").textContent = (st.rush_td || 0);
    }

    // ===== Live / History switch =====
    let liveListenerOn = false;

    function startLive() {
      if (liveListenerOn) return;
      liveListenerOn = true;

      refGame.on("value", snap => {
        const data = snap.val() || {};

        renderMeta(data);

        const homeName = data.team_home || "Local";
        const awayName = data.team_away || "Visitante";
        paintTeamPanel("home", homeName, data.score_home ?? 0, data.possession);
        paintTeamPanel("away", awayName, data.score_away ?? 0, data.possession);

        renderQuarter(data);
        renderTimeline(data);

        const qb = (data.players && data.players.qb) ? data.players.qb : null;
        renderQB(qb);

        // --- POLL SYNC ---
        const pollEnabled = !!data.pollEnabled;
        const container = document.getElementById("pollContainer");
        if (pollEnabled) {
          container.style.display = "block";
          updatePollUI(data);
        } else {
          container.style.display = "none";
        }
      });
    }

    function updatePollUI(data) {
      const votes = data.pollVotes || {};
      const homeName = data.team_home || "Local";
      const awayName = data.team_away || "Visitante";

      // Update names and logos in voting view
      document.getElementById("pollNameHome").textContent = homeName;
      document.getElementById("pollNameAway").textContent = awayName;
      document.getElementById("resNameHome").textContent = homeName.toUpperCase();
      document.getElementById("resNameAway").textContent = awayName.toUpperCase();

      const homeData = teamData[homeName] || {};
      const awayData = teamData[awayName] || {};
      document.getElementById("pollLogoHome").innerHTML = `<img src="${getLogoPath(homeData.logoId)}" onerror="this.style.display='none'"/>`;
      document.getElementById("pollLogoAway").innerHTML = `<img src="${getLogoPath(awayData.logoId)}" onerror="this.style.display='none'"/>`;
      const homeLogoPath = getLogoPath(homeData.logoId);
      const awayLogoPath = getLogoPath(awayData.logoId);
      document.getElementById("pollLogoHome").innerHTML = homeLogoPath ? `<img src="${homeLogoPath}" onerror="this.style.display='none'"/>` : "";
      document.getElementById("pollLogoAway").innerHTML = awayLogoPath ? `<img src="${awayLogoPath}" onerror="this.style.display='none'"/>` : "";

      // Check if user has already voted
      const pollId = data.pollStartTime || "default"; // Use a unique session key if possible
      const voted = localStorage.getItem("voted_" + pollId);

      const options = document.getElementById("voteOptions");
      const results = document.getElementById("pollResults");
      const thanks = document.getElementById("thanksMsg");

      if (voted) {
        options.style.display = "none";
        results.style.display = "flex";
        thanks.style.display = "block";

        // Calculate results
        let homeCount = 0;
        let awayCount = 0;
        for (const k in votes) {
          if (votes[k].team === "home") homeCount++;
          else if (votes[k].team === "away") awayCount++;
        }
        const total = homeCount + awayCount;
        const pctHome = total === 0 ? 50 : Math.round((homeCount / total) * 100);
        const pctAway = total === 0 ? 50 : 100 - pctHome;
