<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marcador en Vivo</title>
    <link rel="stylesheet" href="style.css">
   <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>
<script src="firebase.js"></script>

</head>

<body>

<div class="scoreboard-container">

    <div class="game-header" id="game_info"></div>

    <div class="score-bar">

        <div class="team-box" id="team_home_box">
            <div class="team-name" id="team_home"></div>
            <div class="possession" id="pos_home"></div>
        </div>

        <div class="score-center">
            <span id="score_home"></span> - <span id="score_away"></span>
        </div>

        <div class="team-box" id="team_away_box">
            <div class="team-name" id="team_away"></div>
            <div class="possession" id="pos_away"></div>
        </div>

    </div>

    <div class="quarter-box" id="quarter"></div>

    <div class="timeline-box" id="timeline"></div>

</div>

<script>
  // db viene de firebase.js
  const refTeams = db.ref("teams");
  const refGame  = db.ref("game");

  let teamColors = {};

  // Colores guardados por equipo
  refTeams.on("value", snap => {
    teamColors = snap.val() || {};
  });

  refGame.on("value", snap => {
    const data = snap.val();
    if (!data) return;

    // Encabezado
    const info = `${data.location || ""} • ${data.date || ""}`.trim();
    document.getElementById("game_info").innerText = info || " ";

    // Nombres de equipos
    document.getElementById("team_home").innerText = data.team_home || "";
    document.getElementById("team_away").innerText = data.team_away || "";

    // Colores de caja según teams
    document.getElementById("team_home_box").style.background =
      teamColors[data.team_home]?.color || "#2b4f63";

    document.getElementById("team_away_box").style.background =
      teamColors[data.team_away]?.color || "#1c247a";

    // Marcador
    document.getElementById("score_home").innerText = data.score_home ?? 0;
    document.getElementById("score_away").innerText = data.score_away ?? 0;

    // Estado del partido / cuarto / medio tiempo
    const qEl = document.getElementById("quarter");
    if (data.finished) {
      qEl.innerText = "Partido finalizado";
    } else if (data.quarter === "MT") {
      qEl.innerText = "Medio tiempo";
    } else {
      qEl.innerText = `Cuarto: ${data.quarter || "1Q"}`;
    }

    // Posesión
    document.getElementById("pos_home").innerText =
      data.possession === "home" ? "⬅ Posesión" : "";

    document.getElementById("pos_away").innerText =
      data.possession === "away" ? "Posesión ➡" : "";

    // Timeline
    let html = "";
    (data.timeline || []).forEach(e => {
      html += `<div class="timeline-item">${e}</div>`;
    });
    document.getElementById("timeline").innerHTML = html;
  });
</script>


</body>
</html>
